<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Hospital Filter</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
</head>
<body class="container mt-4">

    <h2 class="mb-4">Hospital Statistics Filter</h2>

    <form method="get" class="mb-3">
        <label for="type" class="form-label">Select Hospital Type:</label>
        <select name="type" id="type" class="form-select" onchange="this.form.submit()">
            <option value="">-- All Types --</option>
            {% for t in types %}
                <option value="{{ t }}" {% if t == selected_type %}selected{% endif %}>{{ t }}</option>
            {% endfor %}
        </select>
        <label for="hospital" class="form-label mt-2">Select Hospital:</label>
        <select name="hospital" id="hospital" class="form-select" onchange="this.form.submit()">
            <option value="">-- All Hospitals --</option>
            {% for h in hospitals %}
                <option value="{{ h }}" {% if h == selected_hospital %}selected{% endif %}>
                    {{ h }}
                </option>
            {% endfor %}
        </select>
    </form>

    {% if selected_hospital %}
        <p>Selected Hospital: <strong>{{ selected_hospital }}</strong></p>
    {% endif %}

    <table class="table table-bordered table-striped">
        <thead class="table-dark">
            <tr>
                <th>Speciality</th>
                <th>Total Visits</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for row in stats %}
            <tr>
                <td>{{ row.speciality }}</td>
                <td>{{ row.total }}</td>
                <td>
                    {% if selected_hospital %}
                       <a href="{% url 'hospital_profile' selected_hospital %}?highlight={{ row.speciality }}" class="btn btn-primary btn-sm">
                           View Profile
                      </a>
                    {% else %}
                        <span class="text-muted">Select a hospital</span>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

</body>
</html>
